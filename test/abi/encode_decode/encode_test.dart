import 'package:blockchain_utils/utils/utils.dart';
import 'package:on_chain/solidity/solidity.dart';
import 'package:test/test.dart';

void main() {
  test('ABI encode/encodedPaded', () {
    for (final i in _testVector) {
      final abiEncode = ABIUtils.encode(types: i["types"], params: i["values"]);
      final abiEncodePacked =
          ABIUtils.encodePacked(types: i["types"], params: i["values"]);
      expect(abiEncode, BytesUtils.fromHexString(i["abiEncode"]));
      expect(abiEncodePacked, BytesUtils.fromHexString(i["abiEncodePacked"]));
    }
  });
}

const List<Map<String, dynamic>> _testVector = [
  {
    "types": ["uint8"],
    "values": ["255"],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000ff",
    "abiEncodePacked": "0xff"
  },
  {
    "types": ["uint16"],
    "values": ["65535"],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000ffff",
    "abiEncodePacked": "0xffff"
  },
  {
    "types": ["uint256"],
    "values": ["12345678901234567890"],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000ab54a98ceb1f0ad2",
    "abiEncodePacked":
        "0x000000000000000000000000000000000000000000000000ab54a98ceb1f0ad2"
  },
  {
    "types": ["int8"],
    "values": ["-128"],
    "abiEncode":
        "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff80",
    "abiEncodePacked": "0x80"
  },
  {
    "types": ["int16"],
    "values": ["-32768"],
    "abiEncode":
        "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8000",
    "abiEncodePacked": "0x8000"
  },
  {
    "types": ["int256"],
    "values": ["-12345678901234567890"],
    "abiEncode":
        "0xffffffffffffffffffffffffffffffffffffffffffffffff54ab567314e0f52e",
    "abiEncodePacked":
        "0xffffffffffffffffffffffffffffffffffffffffffffffff54ab567314e0f52e"
  },
  {
    "types": ["address"],
    "values": ["0x1234567890123456789012345678901234567890"],
    "abiEncode":
        "0x0000000000000000000000001234567890123456789012345678901234567890",
    "abiEncodePacked": "0x1234567890123456789012345678901234567890"
  },
  {
    "types": ["bool"],
    "values": [true],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000001",
    "abiEncodePacked": "0x01"
  },
  {
    "types": ["bool"],
    "values": [false],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x00"
  },
  {
    "types": ["bytes"],
    "values": ["0xdeadbeef"],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000004deadbeef00000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0xdeadbeef"
  },
  {
    "types": ["string"],
    "values": ["Hello, world!"],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000d48656c6c6f2c20776f726c642100000000000000000000000000000000000000",
    "abiEncodePacked": "0x48656c6c6f2c20776f726c6421"
  },
  {
    "types": ["string"],
    "values": ["0x68656c6c6f"],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000c3078363836353663366336660000000000000000000000000000000000000000",
    "abiEncodePacked": "0x307836383635366336633666"
  },
  {
    "types": ["uint8[]"],
    "values": [
      [1, 2, 3, 255]
    ],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000ff",
    "abiEncodePacked":
        "0x00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000ff"
  },
  {
    "types": ["address[2]"],
    "values": [
      [
        "0x1111111111111111111111111111111111111111",
        "0x2222222222222222222222222222222222222222"
      ]
    ],
    "abiEncode":
        "0x00000000000000000000000011111111111111111111111111111111111111110000000000000000000000002222222222222222222222222222222222222222",
    "abiEncodePacked":
        "0x00000000000000000000000011111111111111111111111111111111111111110000000000000000000000002222222222222222222222222222222222222222"
  },
  {
    "types": ["uint256", "address", "bool"],
    "values": ["42", "0xabcdefabcdefabcdefabcdefabcdefabcdefabcd", true],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000abcdefabcdefabcdefabcdefabcdefabcdefabcd0000000000000000000000000000000000000000000000000000000000000001",
    "abiEncodePacked":
        "0x000000000000000000000000000000000000000000000000000000000000002aabcdefabcdefabcdefabcdefabcdefabcdefabcd01"
  },
  {
    "types": ["bytes", "string"],
    "values": ["0x1234", "MRTNETWORK"],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000021234000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a4d52544e4554574f524b00000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x12344d52544e4554574f524b"
  },
  {
    "types": ["uint256[]"],
    "values": [
      ["1", "42", "255", "12345678901234567890"]
    ],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000ff000000000000000000000000000000000000000000000000ab54a98ceb1f0ad2",
    "abiEncodePacked":
        "0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000ff000000000000000000000000000000000000000000000000ab54a98ceb1f0ad2"
  },
  {
    "types": ["int256[]"],
    "values": [
      ["-1", "0", "42", "-12345678901234567890"]
    ],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000004ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002affffffffffffffffffffffffffffffffffffffffffffffff54ab567314e0f52e",
    "abiEncodePacked":
        "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002affffffffffffffffffffffffffffffffffffffffffffffff54ab567314e0f52e"
  },
  {
    "types": ["address[]"],
    "values": [
      [
        "0x1111111111111111111111111111111111111111",
        "0x2222222222222222222222222222222222222222"
      ]
    ],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000011111111111111111111111111111111111111110000000000000000000000002222222222222222222222222222222222222222",
    "abiEncodePacked":
        "0x00000000000000000000000011111111111111111111111111111111111111110000000000000000000000002222222222222222222222222222222222222222"
  },
  {
    "types": ["bytes[]"],
    "values": [
      ["0x1234", "0xdeadbeef", "0xabcdef"]
    ],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004deadbeef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003abcdef0000000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x1234deadbeefabcdef"
  },
  {
    "types": ["string[]"],
    "values": [
      ["hello", "world", "MetaMask"]
    ],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000568656c6c6f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005776f726c6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000084d6574614d61736b000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x68656c6c6f776f726c644d6574614d61736b"
  },
  {
    "types": ["uint256[]", "address[]", "string[]"],
    "values": [
      ["1", "2", "3"],
      [
        "0xabcdefabcdefabcdefabcdefabcdefabcdefabcd",
        "0x1234567890123456789012345678901234567890"
      ],
      ["foo", "bar"]
    ],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000abcdefabcdefabcdefabcdefabcdefabcdefabcd00000000000000000000000012345678901234567890123456789012345678900000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000003666f6f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036261720000000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked":
        "0x000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000000abcdefabcdefabcdefabcdefabcdefabcdefabcd0000000000000000000000001234567890123456789012345678901234567890666f6f626172"
  },
  {
    "name": "Message",
    "types": ["string"],
    "values": ["Hi, Alice!"],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000a48692c20416c6963652100000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x48692c20416c69636521"
  },
  {
    "name": "bool",
    "types": ["bool"],
    "values": [false],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x00"
  },
  {
    "name": "A number",
    "types": ["int32"],
    "values": ["-1"],
    "abiEncode":
        "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
    "abiEncodePacked": "0xffffffff"
  },
  {
    "name": "BBBB4",
    "types": ["string[]"],
    "values": [
      ["one", "two", "three"]
    ],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000036f6e650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000374776f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000057468726565000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked": "0x6f6e6574776f7468726565"
  },
  {
    "name": "BBBB3",
    "types": ["bool[]"],
    "values": [
      [false, true, true, false]
    ],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
    "abiEncodePacked":
        "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
  },
  {
    "name": "BBBB1",
    "types": ["uint32[]"],
    "values": [
      ["1", "2", "5000", "7000"]
    ],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000013880000000000000000000000000000000000000000000000000000000000001b58",
    "abiEncodePacked":
        "0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000013880000000000000000000000000000000000000000000000000000000000001b58"
  },
  {
    "name": "BBBBx",
    "types": ["uint32[]"],
    "values": [
      ["1", "2", "5000", "7000"]
    ],
    "abiEncode":
        "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000013880000000000000000000000000000000000000000000000000000000000001b58",
    "abiEncodePacked":
        "0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000013880000000000000000000000000000000000000000000000000000000000001b58"
  },
  {
    "name": "BBBBx",
    "types": ["uint256[]"],
    "values": [
      [
        "1000000000000000",
        "20000000000000000",
        "50000000000000",
        "700000000000000000"
      ]
    ],
    "abiEncode":
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000038d7ea4c6800000000000000000000000000000000000000000000000000000470de4df82000000000000000000000000000000000000000000000000000000002d79883d200000000000000000000000000000000000000000000000000009b6e64a8ec60000",
    "abiEncodePacked":
        "0x00000000000000000000000000000000000000000000000000038d7ea4c6800000000000000000000000000000000000000000000000000000470de4df82000000000000000000000000000000000000000000000000000000002d79883d200000000000000000000000000000000000000000000000000009b6e64a8ec60000"
  },
  {
    "name": "BBBBx",
    "types": ["int32[]"],
    "values": [
      ["-1", "-2", "-5000", "7000"]
    ],
    "abiEncode":
        "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000004fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec780000000000000000000000000000000000000000000000000000000000001b58",
    "abiEncodePacked":
        "0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec780000000000000000000000000000000000000000000000000000000000001b58"
  }
];
